// session-detail.ts - session detail page HTML
import { escapeHtml } from './escape';
export interface SessionDetailProps { ip: string; sessionId: string; sessionTitle: string; }
export function renderSessionDetailPage({ ip, sessionId, sessionTitle }: SessionDetailProps): string {
  return `<!doctype html><html lang="en"><head><meta charset="UTF-8"/><title>Session ${escapeHtml(sessionTitle || sessionId)}</title><meta name="viewport" content="width=device-width,initial-scale=1" /><style>body{font-family:system-ui,sans-serif;margin:1.5rem;max-width:900px;margin-left:auto;margin-right:auto;} a{color:#0366d6;} input,textarea,button{padding:.5rem;font-size:.95rem;border:1px solid #ccc;border-radius:3px;} button{background:#0366d6;color:white;cursor:pointer;border:none;} button:hover{background:#0256c7;} .row{display:flex;gap:.5rem;margin-bottom:.5rem;} .status{font-size:.75rem;color:#666;margin-bottom:1rem;} .result{font-size:.75rem;color:#666;margin-top:.5rem;} #messages-list{border:1px solid #ddd;padding:1rem;border-radius:4px;margin-top:1rem;max-height:400px;overflow-y:auto;} .message{padding:.5rem;border-bottom:1px solid #eee;font-size:.9rem;} .message-role{font-weight:bold;color:#0366d6;} .message-text{margin-top:.25rem;white-space:pre-wrap;word-break:break-word;}  .session-id{font-size:.6rem;color:#666;margin-top:.25rem;margin-bottom:1rem;} </style></head><body><h1>${escapeHtml(sessionTitle || sessionId)}</h1><div><a href="/sessions/${escapeHtml(ip)}">&larr; Back to sessions for ${escapeHtml(ip)}</a></div><speech-button></speech-button><h2>Messages</h2><div id="messages-status" class="status">Connecting...</div><messages-wrapper><div id="messages-list-container"><div id="messages-list" data-init="@get('/sessions/${escapeHtml(ip)}/${escapeHtml(sessionId)}/messages/stream')"><div>(loading)</div></div></div></messages-wrapper><h2>Send Message</h2><form id="session-message-form" data-on:submit="@post('/sessions/${escapeHtml(ip)}/${escapeHtml(sessionId)}/message'); $messagetext = ''"><div class="row"><textarea id="session-message-input" data-bind:messageText name="messageText" placeholder="Enter message" rows="4" style="flex:1;resize:vertical"></textarea><button type="submit">Send</button></div><div id="session-message-result" class="result"></div></form><h2>First Message Instruction</h2><div class="row"><textarea id="first-message-input" data-bind:firstMessageText name="firstMessageText" placeholder="First message instruction override" rows="2" style="flex:1;resize:vertical"></textarea><button data-on:click="@post('/sessions/${escapeHtml(ip)}/${escapeHtml(sessionId)}/message', { messageText: document.querySelector('#first-message-input').value })">Send Instruction</button></div><div class="session-id">Session: ${escapeHtml(sessionId)}</div></body></html>`;
}
